{
  "version": 3,
  "sources": ["../../../../../apps/cre/cre/public/frappe/frappe/public/js/frappe/web_form/web_form_list.js", "../../../../../apps/frappe/frappe/public/js/frappe/event_emitter.js", "../../../../../apps/cre/cre/public/frappe/frappe/public/js/frappe/web_form/web_form.js", "../../../../../apps/cre/cre/public/frappe/frappe/public/js/frappe/web_form/webform_script.js"],
  "sourcesContent": ["frappe.provide(\"frappe.ui\");\nfrappe.provide(\"frappe.views\");\nfrappe.provide(\"frappe.web_form_list\");\n\nexport default class WebFormList {\n\tconstructor(opts) {\n\t\tObject.assign(this, opts);\n\t\tfrappe.web_form_list = this;\n\t\tthis.wrapper = document.getElementById(\"list-table\");\n\t\tthis.make_actions();\n\t\tthis.make_filters();\n\t\t$('.link-btn').remove();\n\t}\n\n\trefresh() {\n\t\tif (this.table) {\n\t\t\tArray.from(this.table.tBodies).forEach(tbody => tbody.remove());\n\t\t\tlet check = document.getElementById('select-all');\n\t\t\tif (check)\n\t\t\t\tcheck.checked = false;\n\t\t}\n\t\tthis.rows = [];\n\t\tthis.page_length = 20;\n\t\tthis.web_list_start = 0;\n\n\t\tfrappe.run_serially([\n\t\t\t() => this.get_list_view_fields(),\n\t\t\t() => this.get_data(),\n\t\t\t() => this.make_table(),\n\t\t\t() => this.create_more()\n\t\t]);\n\t}\n\n\tmake_filters() {\n\t\tthis.filters = {};\n\t\tthis.filter_input = [];\n\t\tconst filter_area = document.getElementById('list-filters');\n\n\t\tfrappe.call('frappe.website.doctype.web_form.web_form.get_web_form_filters', {\n\t\t\tweb_form_name: this.web_form_name\n\t\t}).then(response => {\n\t\t\tlet fields = response.message;\n\t\t\tfields.forEach(field => {\n\t\t\t\tlet col = document.createElement('div.col-sm-4');\n\t\t\t\tcol.classList.add('col', 'col-sm-3');\n\t\t\t\tfilter_area.appendChild(col);\n\t\t\t\tif (field.default) this.add_filter(field.fieldname, field.default, field.fieldtype);\n\n\t\t\t\tlet input = frappe.ui.form.make_control({\n\t\t\t\t\tdf: {\n\t\t\t\t\t\tfieldtype: field.fieldtype,\n\t\t\t\t\t\tfieldname: field.fieldname,\n\t\t\t\t\t\toptions: field.options,\n\t\t\t\t\t\tonly_select: true,\n\t\t\t\t\t\tlabel: __(field.label),\n\t\t\t\t\t\tonchange: (event) => {\n\t\t\t\t\t\t\t$('#more').remove();\n\t\t\t\t\t\t\tthis.add_filter(field.fieldname, input.value, field.fieldtype);\n\t\t\t\t\t\t\tthis.refresh();\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tparent: col,\n\t\t\t\t\tvalue: field.default,\n\t\t\t\t\trender_input: 1,\n\t\t\t\t});\n\t\t\t\tthis.filter_input.push(input);\n\t\t\t});\n\t\t\tthis.refresh();\n\t\t});\n\t}\n\n\tadd_filter(field, value, fieldtype) {\n\t\tif (!value) {\n\t\t\tdelete this.filters[field];\n\t\t} else {\n\t\t\tif (fieldtype === 'Data') value = ['like', value + '%'];\n\t\t\tObject.assign(this.filters, Object.fromEntries([[field, value]]));\n\t\t}\n\t}\n\n\tget_list_view_fields() {\n\t\treturn frappe\n\t\t\t.call({\n\t\t\t\tmethod:\n\t\t\t\t\t\"frappe.website.doctype.web_form.web_form.get_in_list_view_fields\",\n\t\t\t\targs: { doctype: this.doctype }\n\t\t\t})\n\t\t\t.then(response => (this.fields_list = response.message));\n\t}\n\n\tfetch_data() {\n\t\treturn frappe.call({\n\t\t\tmethod: \"frappe.www.list.get_list_data\",\n\t\t\targs: {\n\t\t\t\tdoctype: this.doctype,\n\t\t\t\tfields: this.fields_list.map(df => df.fieldname),\n\t\t\t\tlimit_start: this.web_list_start,\n\t\t\t\tweb_form_name: this.web_form_name,\n\t\t\t\t...this.filters\n\t\t\t}\n\t\t});\n\t}\n\n\tasync get_data() {\n\t\tlet response = await this.fetch_data();\n\t\tthis.data = await response.message;\n\t}\n\n\tmore() {\n\t\tthis.web_list_start += this.page_length;\n\t\tthis.fetch_data().then((res) => {\n\t\t\tif (res.message.length === 0) {\n\t\t\t\tfrappe.msgprint(__(\"No more items to display\"));\n\t\t\t}\n\t\t\tthis.append_rows(res.message);\n\t\t});\n\n\t}\n\n\tmake_table() {\n\t\tthis.columns = this.fields_list.map(df => {\n\t\t\treturn {\n\t\t\t\tlabel: df.label,\n\t\t\t\tfieldname: df.fieldname,\n\t\t\t\tfieldtype: df.fieldtype\n\t\t\t};\n\t\t});\n\n\t\tif (!this.table) {\n\t\t\tthis.table = document.createElement(\"table\");\n\t\t\tthis.table.classList.add(\"table\");\n\t\t\tthis.make_table_head();\n\t\t}\n\n\t\tif (this.data.length) {\n\t\t\tthis.append_rows(this.data);\n\t\t\tthis.wrapper.appendChild(this.table);\n\t\t} else {\n\t\t\tlet new_button = \"\";\n\t\t\tlet empty_state = document.createElement(\"div\");\n\t\t\tempty_state.classList.add(\"no-result\", \"text-muted\", \"flex\", \"justify-center\", \"align-center\");\n\n\t\t\tfrappe.has_permission(this.doctype, \"\", \"create\", () => {\n\t\t\t\tnew_button = `\n\t\t\t\t\t<a\n\t\t\t\t\t\tclass=\"btn btn-primary btn-sm btn-new-doc hidden-xs\"\n\t\t\t\t\t\thref=\"${window.location.pathname}?new=1\">\n\t\t\t\t\t\t${__(\"Create a new {0}\", [__(this.doctype)])}\n\t\t\t\t\t</a>\n\t\t\t\t`;\n\n\t\t\t\tempty_state.innerHTML = `\n\t\t\t\t\t<div class=\"text-center\">\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\tsrc=\"/assets/frappe/images/ui-states/list-empty-state.svg\"\n\t\t\t\t\t\t\t\talt=\"Generic Empty State\"\n\t\t\t\t\t\t\t\tclass=\"null-state\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<p class=\"small mb-2\">${__(\"No {0} found\", [__(this.doctype)])}</p>\n\t\t\t\t\t\t${new_button}\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\n\t\t\t\tthis.wrapper.appendChild(empty_state);\n\t\t\t});\n\t\t}\n\t}\n\n\tmake_table_head() {\n\t\t// Create Heading\n\t\tlet thead = this.table.createTHead();\n\t\tlet row = thead.insertRow();\n\n\t\tlet th = document.createElement(\"th\");\n\n\t\tlet checkbox = document.createElement(\"input\");\n\t\tcheckbox.type = \"checkbox\";\n\t\tcheckbox.id = \"select-all\";\n\t\tcheckbox.onclick = event =>\n\t\t\tthis.toggle_select_all(event.target.checked);\n\n\t\tth.appendChild(checkbox);\n\t\trow.appendChild(th);\n\n\t\tadd_heading(row, __(\"Sr\"));\n\t\tthis.columns.forEach(col => {\n\t\t\tadd_heading(row, __(col.label));\n\t\t});\n\n\t\tfunction add_heading(row, label) {\n\t\t\tlet th = document.createElement(\"th\");\n\t\t\tth.innerText = label;\n\t\t\trow.appendChild(th);\n\t\t}\n\t}\n\n\tappend_rows(row_data) {\n\t\tconst tbody = this.table.childNodes[1] || this.table.createTBody();\n\t\trow_data.forEach((data_item) => {\n\t\t\tlet row_element = tbody.insertRow();\n\t\t\trow_element.setAttribute(\"id\", data_item.name);\n\n\t\t\tlet row = new frappe.ui.WebFormListRow({\n\t\t\t\trow: row_element,\n\t\t\t\tdoc: data_item,\n\t\t\t\tcolumns: this.columns,\n\t\t\t\tserial_number: this.rows.length + 1,\n\t\t\t\tevents: {\n\t\t\t\t\tonEdit: () => this.open_form(data_item.name),\n\t\t\t\t\tonSelect: () => this.toggle_delete()\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.rows.push(row);\n\t\t});\n\t}\n\n\tmake_actions() {\n\t\tconst actions = document.querySelector(\".list-view-actions\");\n\n\t\tfrappe.has_permission(this.doctype, \"\", \"delete\", () => {\n\t\t\tthis.addButton(actions, \"delete-rows\", \"danger\", true, \"Delete\", () =>\n\t\t\t\tthis.delete_rows()\n\t\t\t);\n\t\t});\n\n\t\tthis.addButton(\n\t\t\tactions,\n\t\t\t\"new\",\n\t\t\t\"primary\",\n\t\t\tfalse,\n\t\t\t\"New\",\n\t\t\t() => (window.location.href = window.location.pathname + \"?new=1\")\n\t\t);\n\t}\n\n\taddButton(wrapper, id, type, hidden, name, action) {\n\t\tif (document.getElementById(id)) return;\n\t\tconst button = document.createElement(\"button\");\n\t\tif (type == \"secondary\") {\n\t\t\tbutton.classList.add(\n\t\t\t\t\"btn\",\n\t\t\t\t\"btn-secondary\",\n\t\t\t\t\"btn-sm\",\n\t\t\t\t\"ml-2\"\n\t\t\t);\n\t\t}\n\t\telse if (type == \"danger\") {\n\t\t\tbutton.classList.add(\n\t\t\t\t\"btn\",\n\t\t\t\t\"btn-danger\",\n\t\t\t\t\"button-delete\",\n\t\t\t\t\"btn-sm\",\n\t\t\t\t\"ml-2\"\n\t\t\t);\n\t\t}\n\t\telse {\n\t\t\tbutton.classList.add(\"btn\", \"btn-primary\", \"btn-sm\", \"ml-2\");\n\t\t}\n\n\t\tbutton.id = id;\n\t\tbutton.innerText = name;\n\t\tbutton.hidden = hidden;\n\n\t\tbutton.onclick = action;\n\t\twrapper.appendChild(button);\n\t}\n\n\tcreate_more() {\n\t\tif (this.rows.length >= this.page_length) {\n\t\t\tconst footer = document.querySelector(\".list-view-footer\");\n\t\t\tthis.addButton(footer, \"more\", \"secondary\", false, \"More\", () =>  this.more());\n\t\t}\n\t}\n\n\ttoggle_select_all(checked) {\n\t\tthis.rows.forEach(row => row.toggle_select(checked));\n\t}\n\n\topen_form(name) {\n\t\twindow.location.href = window.location.pathname + \"?name=\" + name;\n\t}\n\n\tget_selected() {\n\t\treturn this.rows.filter(row => row.is_selected());\n\t}\n\n\ttoggle_delete() {\n\t\tif (!this.settings.allow_delete) return\n\t\tlet btn = document.getElementById(\"delete-rows\");\n\t\tbtn.hidden = !this.get_selected().length;\n\t}\n\n\tdelete_rows() {\n\t\tif (!this.settings.allow_delete) return\n\t\tfrappe\n\t\t\t.call({\n\t\t\t\ttype: \"POST\",\n\t\t\t\tmethod:\n\t\t\t\t\t\"frappe.website.doctype.web_form.web_form.delete_multiple\",\n\t\t\t\targs: {\n\t\t\t\t\tweb_form_name: this.web_form_name,\n\t\t\t\t\tdocnames: this.get_selected().map(row => row.doc.name)\n\t\t\t\t}\n\t\t\t})\n\t\t\t.then(() => {\n\t\t\t\tthis.refresh()\n\t\t\t\tthis.toggle_delete()\n\t\t\t});\n\t}\n};\n\nfrappe.ui.WebFormListRow = class WebFormListRow {\n\tconstructor({ row, doc, columns, serial_number, events, options }) {\n\t\tObject.assign(this, { row, doc, columns, serial_number, events });\n\t\tthis.make_row();\n\t}\n\n\tmake_row() {\n\t\t// Add Checkboxes\n\t\tlet cell = this.row.insertCell();\n\t\tcell.classList.add('list-col-checkbox');\n\n\t\tthis.checkbox = document.createElement(\"input\");\n\t\tthis.checkbox.type = \"checkbox\";\n\t\tthis.checkbox.onclick = event => {\n\t\t\tthis.toggle_select(event.target.checked);\n\t\t\tevent.stopImmediatePropagation();\n\t\t}\n\n\t\tcell.appendChild(this.checkbox);\n\n\t\t// Add Serial Number\n\t\tlet serialNo = this.row.insertCell();\n\t\tserialNo.classList.add('list-col-serial');\n\t\tserialNo.innerText = this.serial_number;\n\n\t\tthis.columns.forEach(field => {\n\t\t\tlet cell = this.row.insertCell();\n\t\t\tlet formatter = frappe.form.get_formatter(field.fieldtype);\n\t\t\tcell.innerHTML = this.doc[field.fieldname] &&\n\t\t\t\t__(formatter(this.doc[field.fieldname], field, {only_value: 1}, this.doc)) || \"\";\n\t\t});\n\n\t\tthis.row.onclick = () => this.events.onEdit();\n\t\tthis.row.style.cursor = \"pointer\";\n\t}\n\n\ttoggle_select(checked) {\n\t\tthis.checkbox.checked = checked;\n\t\tthis.events.onSelect(checked);\n\t}\n\n\tis_selected() {\n\t\treturn this.checkbox.checked;\n\t}\n};\n", "frappe.provide('frappe.utils');\n/**\n * Simple EventEmitterMixin which uses jQuery's event system\n */\nconst EventEmitterMixin = {\n\tinit() {\n\t\tthis.jq = jQuery({});\n\t},\n\n\ttrigger(evt, data) {\n\t\t!this.jq && this.init();\n\t\tthis.jq.trigger(evt, data);\n\t},\n\n\tonce(evt, handler) {\n\t\t!this.jq && this.init();\n\t\tthis.jq.one(evt, (e, data) => handler(data));\n\t},\n\n\ton(evt, handler) {\n\t\t!this.jq && this.init();\n\t\tthis.jq.bind(evt, (e, data) => handler(data));\n\t},\n\n\toff(evt, handler) {\n\t\t!this.jq && this.init();\n\t\tthis.jq.unbind(evt, (e, data) => handler(data));\n\t}\n}\n\nfrappe.utils.make_event_emitter = function(object) {\n\tObject.assign(object, EventEmitterMixin);\n\treturn object;\n};\n\nexport default EventEmitterMixin;\n", "frappe.provide(\"frappe.ui\");\nfrappe.provide(\"frappe.web_form\");\n// import EventEmitterMixin from '../../../../../../frappe/frappe/public/js/frappe/event_emitter';\n\nimport EventEmitterMixin from '/home/ubuntu/environment/bench3/apps/frappe/frappe/public/js/frappe/event_emitter.js';\n\n\nexport default class WebForm extends frappe.ui.FieldGroup {\n\tconstructor(opts) {\n\t\tsuper();\n\t\tObject.assign(this, opts);\n\t\tfrappe.web_form = this;\n\t\tfrappe.web_form.events = {};\n\t\tObject.assign(frappe.web_form.events, EventEmitterMixin);\n\t\tthis.current_section = 0;\n\t}\n\n\tprepare(web_form_doc, doc) {\n\t\tObject.assign(this, web_form_doc);\n\t\tthis.fields = web_form_doc.web_form_fields;\n\t\tthis.doc = doc;\n\t}\n\n\tmake() {\n\t\tsuper.make();\n\t\tthis.set_sections();\n\t\tthis.set_field_values();\n\t\tthis.setup_listeners();\n\t\tif (this.introduction_text) this.set_form_description(this.introduction_text);\n\t\tif (this.allow_print && !this.is_new) this.setup_print_button();\n\t\tif (this.is_new) this.setup_cancel_button();\n\t\tthis.setup_primary_action();\n\t\tthis.setup_previous_next_button();\n\t\tthis.toggle_section();\n\t\t$(\".link-btn\").remove();\n\n\t\t// webform client script\n\t\tfrappe.init_client_script && frappe.init_client_script();\n\t\tfrappe.web_form.events.trigger('after_load');\n\t\tthis.after_load && this.after_load();\n\t}\n\n\ton(fieldname, handler) {\n\t\tlet field = this.fields_dict[fieldname];\n\t\tfield.df.change = () => {\n\t\t\thandler(field, field.value);\n\t\t};\n\t}\n\n\tsetup_listeners() {\n\t\t// Event listener for triggering Save/Next button for Multi Step Forms\n\t\t// Do not use `on` event here since that can be used by user which will render this function useless\n\t\t// setTimeout has 200ms delay so that all the base_control triggers for the fields have been run\n\t\tlet me = this;\n\n\t\tif (!me.is_multi_step_form) {\n\t\t\treturn;\n\t\t}\n\n\t\tfor (let field of $(\".input-with-feedback\")) {\n\t\t\t$(field).change((e) => {\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\tme.toggle_buttons();\n\t\t\t\t}, 200);\n\t\t\t});\n\t\t}\n\t}\n\n\tset_sections() {\n\t\tif (this.sections.length) return;\n\n\t\tthis.sections = $(`.form-section`);\n\t}\n\n\tsetup_previous_next_button() {\n\t\tlet me = this;\n\n\t\tif (!me.is_multi_step_form) {\n\t\t\treturn;\n\t\t}\n\n\t\t$('.web-form-footer').after(`\n\t\t\t<div id=\"form-step-footer\" class=\"text-right\">\n\t\t\t\t<button class=\"btn btn-default btn-previous btn-sm ml-2\">${__(\"Previous\")}</button>\n\t\t\t\t<button class=\"btn btn-default btn-next btn-sm ml-2\">${__(\"Next\")}</button>\n\t\t\t</div>\n\t\t`);\n\n\t\t$('.btn-previous').on('click', function () {\n\t\t\tlet is_validated = me.validate_section();\n\n\t\t\tif (!is_validated) return;\n\n\t\t\t/**\n\t\t\t\tThe eslint utility cannot figure out if this is an infinite loop in backwards and\n\t\t\t\tthrows an error. Disabling for-direction just for this section.\n\t\t\t\tfor-direction doesnt throw an error if the values are hardcoded in the\n\t\t\t\treverse for-loop, but in this case its a dynamic loop.\n\t\t\t\thttps://eslint.org/docs/rules/for-direction\n\t\t\t*/\n\t\t\t/* eslint-disable for-direction */\n\t\t\tfor (let idx = me.current_section; idx < me.sections.length; idx--) {\n\t\t\t\tlet is_empty = me.is_previous_section_empty(idx);\n\t\t\t\tme.current_section = me.current_section > 0 ? me.current_section - 1 : me.current_section;\n\n\t\t\t\tif (!is_empty) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\t/* eslint-enable for-direction */\n\t\t\tme.toggle_section();\n\t\t});\n\n\t\t$('.btn-next').on('click', function () {\n\t\t\tlet is_validated = me.validate_section();\n\n\t\t\tif (!is_validated) return;\n\n\t\t\tfor (let idx = me.current_section; idx < me.sections.length; idx++) {\n\t\t\t\tlet is_empty = me.is_next_section_empty(idx);\n\t\t\t\tme.current_section = me.current_section < me.sections.length ? me.current_section + 1 : me.current_section;\n\n\t\t\t\tif (!is_empty) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tme.toggle_section();\n\t\t});\n\t}\n\n\tset_field_values() {\n\t\tif (this.doc.name) this.set_values(this.doc);\n\t\telse return;\n\t}\n\n\tset_default_values() {\n\t\tlet values = frappe.utils.get_query_params();\n\t\tdelete values.new;\n\t\tthis.set_values(values);\n\t}\n\n\tset_form_description(intro) {\n\t\tlet intro_wrapper = document.getElementById('introduction');\n\t\tintro_wrapper.innerHTML = intro;\n\t\tintro_wrapper.classList.remove('hidden');\n\t}\n\n\tadd_button(name, type, action, wrapper_class=\".web-form-actions\") {\n\t\tconst button = document.createElement(\"button\");\n\t\tbutton.classList.add(\"btn\", \"btn-\" + type, \"btn-sm\", \"ml-2\");\n\t\tbutton.innerHTML = name;\n\t\tbutton.onclick = action;\n\t\tdocument.querySelector(wrapper_class).appendChild(button);\n\t}\n\n\tadd_button_to_footer(name, type, action) {\n\t\tthis.add_button(name, type, action, '.web-form-footer');\n\t}\n\n\tadd_button_to_header(name, type, action) {\n\t\tthis.add_button(name, type, action, '.web-form-actions');\n\t}\n\n\tsetup_primary_action() {\n\t\tthis.add_button_to_header(this.button_label || __(\"Save\", null, \"Button in web form\"), \"primary\", () =>\n\t\t\tthis.save()\n\t\t);\n\n\t\tif (!this.is_multi_step_form && $('.frappe-card').height() > 600) {\n\t\t\t// add button on footer if page is long\n\t\t\tthis.add_button_to_footer(this.button_label || __(\"Save\", null, \"Button in web form\"), \"primary\", () =>\n\t\t\t\tthis.save()\n\t\t\t);\n\t\t}\n\t}\n\n\tsetup_cancel_button() {\n\t\tthis.add_button_to_header(__(\"Cancel\", null, \"Button in web form\"), \"light\", () => this.cancel());\n\t}\n\n\tsetup_print_button() {\n\t\tthis.add_button_to_header(\n\t\t\tfrappe.utils.icon('print'),\n\t\t\t\"light\",\n\t\t\t() => this.print()\n\t\t);\n\t}\n\n\tvalidate_section() {\n\t\tif (this.allow_incomplete) return true;\n\n\t\tlet fields = $(`.form-section:eq(${this.current_section}) .form-control`);\n\t\tlet errors = [];\n\t\tlet invalid_values = [];\n\n\t\tfor (let field of fields) {\n\t\t\tlet fieldname = $(field).attr(\"data-fieldname\");\n\t\t\tif (!fieldname) continue;\n\n\t\t\tfield = this.fields_dict[fieldname];\n\n\t\t\tif (field.get_value) {\n\t\t\t\tlet value = field.get_value();\n\t\t\t\tif (field.df.reqd && is_null(typeof value === 'string' ? strip_html(value) : value)) errors.push(__(field.df.label));\n\n\t\t\t\tif (field.df.reqd && field.df.fieldtype === 'Text Editor' && is_null(strip_html(cstr(value)))) errors.push(__(field.df.label));\n\n\t\t\t\tif (field.df.invalid) invalid_values.push(__(field.df.label));\n\t\t\t}\n\t\t}\n\n\t\tlet message = '';\n\t\tif (invalid_values.length) {\n\t\t\tmessage += __('Invalid values for fields:', null, 'Error message in web form');\n\t\t\tmessage += '<br><br><ul><li>' + invalid_values.join('<li>') + '</ul>';\n\t\t}\n\n\t\tif (errors.length) {\n\t\t\tmessage += __('Mandatory fields required:', null, 'Error message in web form');\n\t\t\tmessage += '<br><br><ul><li>' + errors.join('<li>') + '</ul>';\n\t\t}\n\n\t\tif (invalid_values.length || errors.length) {\n\t\t\tfrappe.msgprint({\n\t\t\t\ttitle: __('Error', null, 'Title of error message in web form'),\n\t\t\t\tmessage: message,\n\t\t\t\tindicator: 'orange'\n\t\t\t});\n\t\t}\n\n\t\treturn !(errors.length || invalid_values.length);\n\t}\n\n\ttoggle_section() {\n\t\tif (!this.is_multi_step_form) return;\n\n\t\tthis.toggle_previous_button();\n\t\tthis.hide_sections();\n\t\tthis.show_section();\n\t\tthis.toggle_buttons();\n\t}\n\n\ttoggle_buttons() {\n\t\tfor (let idx = this.current_section; idx < this.sections.length; idx++) {\n\t\t\tif (this.is_next_section_empty(idx)) {\n\t\t\t\tthis.show_save_and_hide_next_button();\n\t\t\t} else {\n\t\t\t\tthis.show_next_and_hide_save_button();\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tis_next_section_empty(section) {\n\t\tif (section + 1 > this.sections.length) return true;\n\n\t\tlet _section = $(`.form-section:eq(${section + 1})`);\n\t\tlet visible_controls = _section.find(\".frappe-control:not(.hide-control)\");\n\n\t\treturn !visible_controls.length ? true : false;\n\t}\n\n\tis_previous_section_empty(section) {\n\t\tif (section - 1 > this.sections.length) return true;\n\n\t\tlet _section = $(`.form-section:eq(${section - 1})`);\n\t\tlet visible_controls = _section.find(\".frappe-control:not(.hide-control)\");\n\n\t\treturn !visible_controls.length ? true : false;\n\t}\n\n\tshow_save_and_hide_next_button() {\n\t\t$('.btn-next').hide();\n\t\t$('.web-form-footer').show();\n\t}\n\n\tshow_next_and_hide_save_button() {\n\t\t$('.btn-next').show();\n\t\t$('.web-form-footer').hide();\n\t}\n\n\ttoggle_previous_button() {\n\t\tthis.current_section == 0 ? $('.btn-previous').hide() : $('.btn-previous').show();\n\t}\n\n\tshow_section() {\n\t\t$(`.form-section:eq(${this.current_section})`).show();\n\t}\n\n\thide_sections() {\n\t\tfor (let idx=0; idx < this.sections.length; idx++) {\n\t\t\tif (idx !== this.current_section) {\n\t\t\t\t$(`.form-section:eq(${idx})`).hide();\n\t\t\t}\n\t\t}\n\t}\n\n\tsave() {\n\t\tlet is_new = this.is_new;\n\t\tif (this.validate && !this.validate()) {\n\t\t\tfrappe.throw(__(\"Couldn't save, please check the data you have entered\"), __(\"Validation Error\"));\n\t\t}\n\n\t\t// validation hack: get_values will check for missing data\n\t\tlet doc_values = super.get_values(this.allow_incomplete);\n\n\t\tif (!doc_values) return;\n\n\t\tif (window.saving) return;\n\t\tlet for_payment = Boolean(this.accept_payment && !this.doc.paid);\n\n\t\tObject.assign(this.doc, doc_values);\n\t\tthis.doc.doctype = this.doc_type;\n\t\tthis.doc.web_form_name = this.name;\n\n\t\t// Save\n\t\twindow.saving = true;\n\t\tfrappe.form_dirty = false;\n\n\t\tfrappe.call({\n\t\t\ttype: \"POST\",\n\t\t\tmethod: \"frappe.website.doctype.web_form.web_form.accept\",\n\t\t\targs: {\n\t\t\t\tdata: this.doc,\n\t\t\t\tweb_form: this.name,\n\t\t\t\tdocname: this.doc.name,\n\t\t\t\tfor_payment\n\t\t\t},\n\t\t\tcallback: response => {\n\t\t\t\t// Check for any exception in response\n\t\t\t\tif (!response.exc) {\n\t\t\t\t\t// Success\n\t\t\t\t\tthis.handle_success(response.message);\n\t\t\t\t\tfrappe.web_form.events.trigger('after_save');\n\t\t\t\t\tthis.after_save && this.after_save();\n\t\t\t\t\t// args doctype and docname added to link doctype in file manager\n\t\t\t\t\tif (is_new && (response.message.attachment || response.message.file)) {\n\t\t\t\t\t\tfrappe.call({\n\t\t\t\t\t\t\ttype: 'POST',\n\t\t\t\t\t\t\tmethod: \"frappe.handler.upload_file\",\n\t\t\t\t\t\t\targs: {\n\t\t\t\t\t\t\t\tfile_url: response.message.attachment || response.message.file,\n\t\t\t\t\t\t\t\tdoctype: response.message.doctype,\n\t\t\t\t\t\t\t\tdocname: response.message.name\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\talways: function() {\n\t\t\t\twindow.saving = false;\n\t\t\t}\n\t\t});\n\t\treturn true;\n\t}\n\n\tprint() {\n\t\twindow.open(`/printview?\n\t\t\tdoctype=${this.doc_type}\n\t\t\t&name=${this.doc.name}\n\t\t\t&format=${this.print_format || \"Standard\"}`, '_blank');\n\t}\n\n\tcancel() {\n\t\twindow.location.href = window.location.pathname;\n\t}\n\n\thandle_success(data) {\n\t\tif (this.accept_payment && !this.doc.paid) {\n\t\t\twindow.location.href = data;\n\t\t}\n\n\t\tconst success_message =\n\t\t\tthis.success_message || __(\"Submitted\");\n\n\t\tfrappe.toast({message: success_message, indicator:'green'});\n\n\t\t// redirect\n\t\tsetTimeout(() => {\n\t\t\tif (this.success_url) {\n\t\t\t\twindow.location.href = this.success_url;\n\t\t\t} else if(this.login_required) {\n\t\t\t\twindow.location.href =\n\t\t\t\t\twindow.location.pathname + \"?name=\" + data.name;\n\t\t\t}\n\t\t}, 2000);\n\t}\n}\n", "import WebFormList from './web_form_list'\nimport WebForm from './web_form'\n\nfrappe.ready(function() {\n\tlet query_params = frappe.utils.get_query_params();\n\tlet wrapper = $(\".web-form-wrapper\");\n\tlet is_list = parseInt(wrapper.data('is-list')) || query_params.is_list;\n\tlet webform_doctype = wrapper.data('web-form-doctype');\n\tlet webform_name = wrapper.data('web-form');\n\tlet login_required = parseInt(wrapper.data('login-required'));\n\tlet allow_delete = parseInt(wrapper.data('allow-delete'));\n\tlet doc_name = query_params.name || '';\n\tlet is_new = query_params.new;\n\n\tif (login_required) show_login_prompt();\n\telse if (is_list) show_grid();\n\telse show_form(webform_doctype, webform_name, is_new);\n\n\tdocument.querySelector(\"body\").style.display = \"block\";\n\n\tfunction show_login_prompt() {\n\t\tconst login_required = new frappe.ui.Dialog({\n\t\t\ttitle: __(\"Not Permitted\"),\n\t\t\tprimary_action_label: __(\"Login\"),\n\t\t\tprimary_action: () => {\n\t\t\t\twindow.location.replace('/login?redirect-to=' + window.location.pathname);\n\t\t\t}\n\t\t});\n\t\tlogin_required.set_message(__(\"You are not permitted to access this page.\"));\n\t\tlogin_required.show();\n\t}\n\n\tfunction show_grid() {\n\t\tnew WebFormList({\n\t\t\tparent: wrapper,\n\t\t\tdoctype: webform_doctype,\n\t\t\tweb_form_name: webform_name,\n\t\t\tsettings: {\n\t\t\t\tallow_delete\n\t\t\t}\n\t\t});\n\t}\n\n\tfunction show_form() {\n\t\tlet web_form = new WebForm({\n\t\t\tparent: wrapper,\n\t\t\tis_new,\n\t\t\tweb_form_name: webform_name,\n\t\t});\n\n\t\tget_data().then(r => {\n\t\t\tconst data = setup_fields(r.message);\n\t\t\tlet web_form_doc = data.web_form;\n\n\t\t\t// if (web_form_doc.name && web_form_doc.allow_edit === 0) {\n\t\t\t// \tif (!window.location.href.includes(\"?new=1\")) {\n\t\t\t// \t\twindow.location.replace(window.location.pathname + \"?new=1\");\n\t\t\t// \t}\n\t\t\t// }\n\t\t\tlet doc = r.message.doc || build_doc(r.message);\n\t\t\tweb_form.prepare(web_form_doc, r.message.doc && web_form_doc.allow_edit === 1 ? r.message.doc : {});\n\t\t\tweb_form.make();\n\t\t\tweb_form.set_default_values();\n\t\t})\n\n\t\tfunction build_doc(form_data) {\n\t\t\tlet doc = {};\n\t\t\tform_data.web_form.web_form_fields.forEach(df => {\n\t\t\t\tif (df.default) return doc[df.fieldname] = df.default;\n\t\t\t});\n\t\t\treturn doc;\n\t\t}\n\n\t\tfunction get_data() {\n\t\t\treturn frappe.call({\n\t\t\t\tmethod: \"frappe.website.doctype.web_form.web_form.get_form_data\",\n\t\t\t\targs: {\n\t\t\t\t\tdoctype: webform_doctype,\n\t\t\t\t\tdocname: doc_name,\n\t\t\t\t\tweb_form_name: webform_name\n\t\t\t\t},\n\t\t\t\tfreeze: true\n\t\t\t});\n\t\t}\n\n\t\tfunction setup_fields(form_data) {\n\t\t\tform_data.web_form.web_form_fields.map(df => {\n\t\t\t\tdf.is_web_form = true;\n\t\t\t\tif (df.fieldtype === \"Table\") {\n\t\t\t\t\tdf.get_data = () => {\n\t\t\t\t\t\tlet data = [];\n\t\t\t\t\t\tif (form_data.doc) {\n\t\t\t\t\t\t\tdata = form_data.doc[df.fieldname];\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn data;\n\t\t\t\t\t};\n\n\t\t\t\t\tdf.fields = form_data[df.fieldname];\n\t\t\t\t\t$.each(df.fields || [], function(_i, field) {\n\t\t\t\t\t\tif (field.fieldtype === \"Link\") {\n\t\t\t\t\t\t\tfield.only_select = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfield.is_web_form = true;\n\t\t\t\t\t});\n\n\t\t\t\t\tif (df.fieldtype === \"Attach\") {\n\t\t\t\t\t\tdf.is_private = true;\n\t\t\t\t\t}\n\n\t\t\t\t\tdelete df.parent;\n\t\t\t\t\tdelete df.parentfield;\n\t\t\t\t\tdelete df.parenttype;\n\t\t\t\t\tdelete df.doctype;\n\n\t\t\t\t\treturn df;\n\t\t\t\t}\n\t\t\t\tif (df.fieldtype === \"Link\") {\n\t\t\t\t\tdf.only_select = true;\n\t\t\t\t}\n\t\t\t\tif ([\"Attach\", \"Attach Image\"].includes(df.fieldtype)) {\n\t\t\t\t\tif (typeof df.options !== \"object\") {\n\t\t\t\t\t\tdf.options = {};\n\t\t\t\t\t}\n\t\t\t\t\tdf.options.disable_file_browser = true;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn form_data;\n\t\t}\n\t}\n});\n"],
  "mappings": "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",
  "names": []
}
