{% extends "templates/page.html" %}

{% from "cre/templates/includes/data_item_macro.html" import data_item %}
{% from "cre/templates/includes/avatar_macro.html" import avatar %}


{% set this_property = doc.as_dict() %}


{% block title %}
{{ doc.name }}
{% endblock %}

{% block head_include %}
<link rel="stylesheet" href="/assets/frappe/css/font-awesome.css">
{% endblock %}

{% block page_title %}
<div class="col mr-auto">
    <ol class="breadcrumb breadcrumb-arrows" aria-label="breadcrumbs">
        <li class="breadcrumb-item"><a href="/dashboard/properties/all"><small>Marketplace</small></a></li>
        <li class="breadcrumb-item active text-truncate" aria-current="page"><a href="#"><small>{{ this_property.property_name }}</small></a></li>
    </ol>
</div>
{% endblock %}


{% block page_actions %}
<div class="col-auto">
    <div class="btn-list">
        <div data-bs-toggle="tooltip" data-bs-placement="bottom" title="Print">
            <a href="/printview?doctype=Property&name={{ this_property.name }}&format=Standard" class="btn d-none d-sm-inline-block btn-icon">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-printer" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                    <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                    <path d="M17 17h2a2 2 0 0 0 2 -2v-4a2 2 0 0 0 -2 -2h-14a2 2 0 0 0 -2 2v4a2 2 0 0 0 2 2h2"></path>
                    <path d="M17 9v-4a2 2 0 0 0 -2 -2h-6a2 2 0 0 0 -2 2v4"></path>
                    <rect x="7" y="13" width="10" height="8" rx="2"></rect>
                </svg>
            </a>
            <a href="/printview?doctype=Property&name={{ this_property.name }}&format=Standard" class="btn d-sm-none btn-icon">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-printer" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                    <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                    <path d="M17 17h2a2 2 0 0 0 2 -2v-4a2 2 0 0 0 -2 -2h-14a2 2 0 0 0 -2 2v4a2 2 0 0 0 2 2h2"></path>
                    <path d="M17 9v-4a2 2 0 0 0 -2 -2h-6a2 2 0 0 0 -2 2v4"></path>
                    <rect x="7" y="13" width="10" height="8" rx="2"></rect>
                </svg> </a>

        </div>
        <div data-bs-toggle="tooltip" data-bs-placement="bottom" title="Share Property">
            <a href="#" class="btn d-none d-sm-inline-block btn-icon like-icon" data-bs-toggle="modal" data-bs-target="#modal-report">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-share" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                    <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                    <circle cx="6" cy="12" r="3"></circle>
                    <circle cx="18" cy="6" r="3"></circle>
                    <circle cx="18" cy="18" r="3"></circle>
                    <line x1="8.7" y1="10.7" x2="15.3" y2="7.3"></line>
                    <line x1="8.7" y1="13.3" x2="15.3" y2="16.7"></line>
                </svg>
            </a>
            <a href="#" class="btn d-sm-none btn-icon like-icon" data-bs-toggle="modal" data-bs-target="#modal-report" aria-label="Create new report">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-share" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                    <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                    <circle cx="6" cy="12" r="3"></circle>
                    <circle cx="18" cy="6" r="3"></circle>
                    <circle cx="18" cy="18" r="3"></circle>
                    <line x1="8.7" y1="10.7" x2="15.3" y2="7.3"></line>
                    <line x1="8.7" y1="13.3" x2="15.3" y2="16.7"></line>
                </svg> </a>

        </div>
        <div data-bs-toggle="tooltip" data-bs-placement="bottom" title="Save Property">
            <a href="#" class="btn d-none d-sm-inline-block btn-icon like-icon  px-1">
                <button class="switch-icon property-like-button" data-bs-toggle="switch-icon">
                    <span class="switch-icon-a">
                        <!-- Download SVG icon from http://tabler-icons.io/i/star -->
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-star p-0" style="display:inline;" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                            <path d="M12 17.75l-6.172 3.245l1.179 -6.873l-5 -4.867l6.9 -1l3.086 -6.253l3.086 6.253l6.9 1l-5 4.867l1.179 6.873z"></path>
                        </svg>
                        <!-- SVG icon code -->
                    </span>
                    <span class="switch-icon-b text-yellow">
                        <!-- Download SVG icon from http://tabler-icons.io/i/star -->
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-star icon-filled" style="display:inline;" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                            <path d="M12 17.75l-6.172 3.245l1.179 -6.873l-5 -4.867l6.9 -1l3.086 -6.253l3.086 6.253l6.9 1l-5 4.867l1.179 6.873z"></path>
                        </svg>
                        <!-- SVG icon code with class="icon-filled" -->
                    </span>
                </button>

            </a>
            <a href="#" class="btn d-sm-none btn-icon like-icon px-1">
                <button class="switch-icon property-like-button" data-bs-toggle="switch-icon">
                    <span class="switch-icon-a">
                        <!-- Download SVG icon from http://tabler-icons.io/i/star -->
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-star p-0" style="display:inline;" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                            <path d="M12 17.75l-6.172 3.245l1.179 -6.873l-5 -4.867l6.9 -1l3.086 -6.253l3.086 6.253l6.9 1l-5 4.867l1.179 6.873z"></path>
                        </svg>
                        <!-- SVG icon code -->
                    </span>
                    <span class="switch-icon-b text-yellow">
                        <!-- Download SVG icon from http://tabler-icons.io/i/star -->
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-star icon-filled" style="display:inline;" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                            <path d="M12 17.75l-6.172 3.245l1.179 -6.873l-5 -4.867l6.9 -1l3.086 -6.253l3.086 6.253l6.9 1l-5 4.867l1.179 6.873z"></path>
                        </svg>
                        <!-- SVG icon code with class="icon-filled" -->
                    </span>
                </button>

            </a>





            <!--<a href="#" class="btn d-none d-sm-inline-block btn-icon switch-icon-a text-muted" data-bs-toggle="modal" data-bs-target="#modal-report">-->
            <!--    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-star" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">-->
            <!--        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>-->
            <!--        <path d="M12 17.75l-6.172 3.245l1.179 -6.873l-5 -4.867l6.9 -1l3.086 -6.253l3.086 6.253l6.9 1l-5 4.867l1.179 6.873z"></path>-->
            <!--    </svg>-->
            <!--</a>-->
            <!--<a href="#" class="btn d-sm-none btn-icon switch-icon-b text-yellow" data-bs-toggle="modal" data-bs-target="#modal-report" aria-label="Create new report">-->
            <!--    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-star icon-filled" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">-->
            <!--        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>-->
            <!--        <path d="M12 17.75l-6.172 3.245l1.179 -6.873l-5 -4.867l6.9 -1l3.086 -6.253l3.086 6.253l6.9 1l-5 4.867l1.179 6.873z"></path>-->
            <!--    </svg> </a>-->
        </div>
        <!--{{ frappe.render_template('templates/includes/cre-feedback/cre-feedback.html', {'user_feedback': user_feedback, 'like_count': like_count}) }}-->
    </div>
</div>
{% endblock %}

{% block page_content %}


{% set tasks = frappe.get_all('Comment', filters={'reference_name': doc.name, 'reference_doctype': 'Property', 'comment_type': 'Comment'}, fields=['*']) %}


<div class="row row-cards">
    <div class="col-12">
        <div class="row">
            <div class="col-md-3 m-auto">
                <a href="#">
                    <div id="carousel-controls" class="carousel slide" data-bs-ride="carousel">
                        <div class="carousel-inner">
                            <div class="carousel-item active">
                                <div class="embed-responsive embed-responsive-16by9">
                                    <img class="d-block w-100 embed-responsive-item" alt="" src="{{ doc.image }}" style="object-fit: cover;">

                                </div>

                            </div>
                            {% for image in doc.gallery %}
                            <div class="carousel-item">
                                <div class="embed-responsive embed-responsive-16by9">
                                    <img class="d-block w-100 embed-responsive-item" alt="" src="{{ image.image }}" style="object-fit: cover;">


                                </div>
                            </div>
                            {% endfor %}

                        </div>
                        <a class="carousel-control-prev" href="#carousel-controls" role="button" data-bs-slide="prev">
                            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                            <span class="visually-hidden">Previous</span>
                        </a>
                        <a class="carousel-control-next" href="#carousel-controls" role="button" data-bs-slide="next">
                            <span class="carousel-control-next-icon" aria-hidden="true"></span>
                            <span class="visually-hidden">Next</span>
                        </a>
                    </div>

                </a>
            </div>
            <div class="col-md-9 m-auto">
                <div class="card">
                    <div class="card-body">
                        <h2 class="text-center">{{ doc.property_name }}</h2>
                        <div class="mb-2 text-center"> <small class="text-muted">{{ doc.tag_line }}</small></div>
                        <div class="mb-3 text-center"> <small class="text-muted">The offer submission window will open on the date of the webinar. Please see webinar details below.</small></div>

                        <div class="btn-list justify-content-center py-2">
                            {% if doc.has_flyer and not doc.has_om %}
                            <a href="#" class="btn btn-warning">
                                Download Flyer
                            </a>
                            {% elif doc.has_om %}
                            <a href="#" class="btn btn-warning">
                                Download OM
                            </a>
                            {% else %}
                            <a href="#" class="btn btn-warning">
                                Request Info
                            </a>


                            {% endif %}
                            <a href="/dashboard/offers/new?new=1&property={{ doc.name }}" class="btn btn-primary">
                                Submit LOI
                            </a>
                        </div>
                    </div>
                    <div class="col-auto">
                        <div class="mb-2 justify-content-center">


                        </div>
                        <div class="mb-1 text-center"><small class="text-muted">Last updated {{ frappe.utils.pretty_date(this_property.modified) }}</small></div>
                    </div>
                </div>

            </div>
        </div>
    </div>
    <div class="col-12">
        <div class="row">
            <div class="col-md-3 col-sm-12">
                <div class="card">
                    <div class="accordion" id="accordion-example">
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="heading-1">
                                <button class="accordion-button " type="button" data-bs-toggle="collapse" data-bs-target="#collapse-1" aria-expanded="true">
                                    Active
                                </button>
                            </h2>
                            <div id="collapse-1" class="accordion-collapse collapse show" data-bs-parent="#accordion-example">
                                <div class="accordion-body pt-0">
                                    <dl class="row">
                                        <dt class="col-5"><small>Asking Price</small></dt>
                                        <dd class="col-7">{{ frappe.utils.fmt_money(this_property.price,currency="$") }}</dd>
                                        <dt class="col-5"><small>Price/SF</small></dt>
                                        <dd class="col-7">{{ frappe.utils.fmt_money(this_property.price_sf,currency="$") }}</dd>
                                        <dt class="col-5"><small>Cap Rate</small></dt>
                                        <dd class="col-7">{{ frappe.format(this_property.cap_rate, {'fieldtype': 'Percent'}) }}</dd>
                                        <dt class="col-5"><small>NOI</small></dt>
                                        <dd class="col-7">{{ frappe.utils.fmt_money(this_property.noi,currency="$") }}</dd>

                                    </dl>
                                </div>
                            </div>
                        </div>
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="heading-2">
                                <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse-2" aria-expanded="false">
                                    Address
                                </button>
                            </h2>
                            <div id="collapse-2" class="accordion-collapse collapse show" data-bs-parent="#accordion-example">
                                <div class="accordion-body pt-0">
                                    <dl class="row">
                                        <dt class="col-5"><small>Location</small></dt>
                                        <dd class="col-7">{{ doc.city }}, {{ doc.state }}</dd>

                                    </dl>
                                </div>
                            </div>
                        </div>
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="heading-3">
                                <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse-3" aria-expanded="false">
                                    Details
                                </button>
                            </h2>
                            <div id="collapse-3" class="accordion-collapse collapse show" data-bs-parent="#accordion-example">
                                <div class="accordion-body pt-0">
                                    <dl class="row">
                                        <dt class="col-5"><small>Property Use</small></dt>
                                        <dd class="col-7">
                                            {% if doc.property_types %}
                                            {% for item in list(doc.property_types) %}
                                            <span class="badge badge-pill bg-blue mb-1 mt-1">{{ item.tag }}</span>
                                            {% endfor %}
                                            {% endif %}
                                        </dd>
                                        {{ data_item('Tenancy', doc.tenancy, 'data') }}
                                        {{ data_item('Occupancy', doc.occupancy, 'percent', precision=0) }}
                                        {{ data_item('Building Area', doc.rba, 'number', precision=0, label_2="SF") }}
                                        {{ data_item('Land Area', doc.land_area, 'number', precision=2, label_2="Acres") }}
                                        {{ data_item('Zoning', doc.zoning, 'data') }}
                                        {{ data_item('Year Built', doc.year_built, 'data') }}
                                        {{ data_item('Building Class', doc.class, 'data') }}
                                        {{ data_item('Opportunity Zone', doc.opportunity_zone, 'data') }}
                                        {{ data_item('Units', doc.units, 'number', precision=0) }}
                                        {{ data_item('Zoning', doc.zoning, 'data') }}
                                        {{ data_item('Lease Type', doc.lease_type, 'data') }}
                                        {{ data_item('Lease Term', doc.lease_term, 'data') }}
                                        {{ data_item('Lease Expiration', doc.lease_expiration, 'data') }}
                                        {{ data_item('Number of Tenants', doc.number_of_tenants, 'number', precision=0) }}

                                    </dl>
                                </div>
                            </div>
                        </div>
                        {% if this_property.investment_description %}
                        <div class="accordion-item d-sm-block d-md-none">
                            <h2 class="accordion-header" id="heading-4">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse-4" aria-expanded="false">
                                    Investment Summary
                                </button>
                            </h2>
                            <div id="collapse-4" class="accordion-collapse collapse" data-bs-parent="#accordion-example">
                                <div class="accordion-body pt-0">
                                    {{ this_property.investment_description }}
                                </div>
                            </div>
                        </div>
                        {% endif %}

                        {% if this_property.marketing_description %}
                        <div class="accordion-item d-sm-block d-md-none">
                            <h2 class="accordion-header" id="heading-5">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse-5" aria-expanded="false">
                                    Marketing Description
                                </button>
                            </h2>
                            <div id="collapse-5" class="accordion-collapse collapse" data-bs-parent="#accordion-example">
                                <div class="accordion-body pt-0">
                                    {{ this_property.marketing_description }}
                                </div>
                            </div>
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>
            <div class="col-md-9 col-sm-12 ">
                <div class="row row-cards">
                    {% if this_property.investment_description %}
                    <div class="col-12 d-none d-lg-block">
                        <div class="card">
                            <div class="card-header">
                                Investment Summary
                            </div>
                            <div class="card-body">
                                {{ this_property.investment_description }}
                            </div>
                        </div>
                    </div>
                    {% endif %}

                    {% if this_property.marketing_description %}
                    <div class="col-12">
                        <div class="card d-none d-md-block">
                            <div class="card-header">
                                Marketing Description
                            </div>
                            <div class="card-body">
                                {{ this_property.marketing_description }}
                            </div>
                        </div>

                    </div>
                    {% endif %}
                    <div class="col-12">
                        <div class="card d-none d-md-block">
                            <div class="card-body">
                                <label class="form-label">
                                    <h3>Leave a Comment</h3><small>Please leave a comment or feedback for your investment advisor. Note all communication is private between you and your advisor.</small>
                                </label>
                                <textarea id="comment-content" class="form-control" data-bs-toggle="autosize" placeholder="Type somethingâ€¦"></textarea>
                                <div class="btn-list justify-content-end py-2">
                                    <div class="col-auto">
                                        <a id="comment-save" href="#" class="btn btn-primary">
                                            Comment
                                        </a>

                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div class="col-12">
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">Activity Feed</h3>
                                <div class="card-actions">
                                    <select class="form-select">
                                        <option value="1">All Properties</option>
                                        <option value="2">Two</option>
                                        <option value="3">Three</option>
                                    </select>
                                </div>
                            </div>
                            <div id="comment-section" class="card-body">
                                <div class="divide-y">
                                    {% for comment in tasks %}

                                    <div>
                                        <div class="row">
                                            <div class="col-auto">

                                                {{ avatar(comment.comment_by, size="sm") }}
                                            </div>
                                            <div class="col">
                                                <div class="text-truncate mb-1">
                                                    {% if comment.comment_by == user %}
                                                    {% set user_mask='You' %}
                                                    {% endif %}
                                                    <strong>{{ user_mask or comment.comment_by }}</strong><span class="text-muted"> commented {{ frappe.utils.pretty_date(comment.creation) }} </span>
                                                </div>
                                                <div>{{ comment.content }}</div>
                                            </div>
                                            <div class="col-auto align-self-center">
                                                {% if comment.comment_by == user %}
                                                <a id="{{ comment.name }}" class="delete-comment" href="#">Delete</a>

                                                {% else %}
                                                <div class="badge bg-primary"></div>

                                                {% endif %}



                                            </div>
                                        </div>
                                    </div>
                                    {% endfor %}

                                </div>
                            </div>
                        </div>
                    </div>

                </div>


            </div>
        </div>
    </div>
    <!--<div class="col-lg-6">-->
    <!--    <div class="row row-cards">-->
    <!--<div class="col-12">-->
    <!--    <div class="card">-->
    <!--        <div class="card-body p-0">-->
    <!--            <div id="carousel-controls" class="carousel slide" data-bs-ride="carousel">-->
    <!--                <div class="carousel-inner">-->
    <!--                    <div class="carousel-item active">-->
    <!--                        <div class="embed-responsive embed-responsive-16by9">-->
    <!--                            <img class="d-block w-100 embed-responsive-item" alt="" src="{{ doc.image }}" style="object-fit: cover;">-->

    <!--                        </div>-->

    <!--                    </div>-->
    <!--                    {% for image in doc.gallery %}-->
    <!--                    <div class="carousel-item">-->
    <!--                        <div class="embed-responsive embed-responsive-16by9">-->
    <!--                            <img class="d-block w-100 embed-responsive-item" alt="" src="{{ image.image }}" style="object-fit: cover;">-->


    <!--                        </div>-->
    <!--                    </div>-->
    <!--                    {% endfor %}-->

    <!--                </div>-->
    <!--                <a class="carousel-control-prev" href="#carousel-controls" role="button" data-bs-slide="prev">-->
    <!--                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>-->
    <!--                    <span class="visually-hidden">Previous</span>-->
    <!--                </a>-->
    <!--                <a class="carousel-control-next" href="#carousel-controls" role="button" data-bs-slide="next">-->
    <!--                    <span class="carousel-control-next-icon" aria-hidden="true"></span>-->
    <!--                    <span class="visually-hidden">Next</span>-->
    <!--                </a>-->
    <!--            </div>-->
    <!--        </div>-->
    <!--    </div>-->
    <!--</div>-->
    <!--        {% if this_property.investment_description %}-->
    <!--        <div class="col-12">-->
    <!--            <div class="card">-->
    <!--                <div class="card-header">-->
    <!--                    Investment Summary-->
    <!--                </div>-->
    <!--                <div class="card-body">-->
    <!--                    {{ this_property.investment_description }}-->
    <!--                </div>-->
    <!--            </div>-->
    <!--        </div>-->
    <!--        {% endif %}-->

    <!--        {% if this_property.marketing_description %}-->
    <!--        <div class="col-12">-->
    <!--            <div class="card">-->
    <!--                <div class="card-header">-->
    <!--                    Opportunity Summary-->
    <!--                </div>-->
    <!--                <div class="card-body">-->
    <!--                    {{ this_property.marketing_description }}-->
    <!--                </div>-->
    <!--            </div>-->

    <!--        </div>-->
    <!--        {% endif %}-->
    <!--    </div>-->

    <!--</div>-->
    <!--<div class="col-lg-6">-->
    <!--    <div class="row row-cards">-->
    <!--<div class="col-12">-->
    <!--    <div class="card">-->
    <!--        <div class="card-body">-->
    <!--            <h2 class="text-center">{{ doc.property_name }}</h2>-->
    <!--            <div class="mb-2 text-center"> <small class="text-muted">{{ doc.tag_line }}</small></div>-->
    <!--            <div class="mb-3 text-center"> <small class="text-muted">The offer submission window will open on the date of the webinar. Please see webinar details below.</small></div>-->
    <!--            <div class="mb-2 text-center"><a href="#" class="btn btn-outline-primary">Indicate Interest</a></div>-->
    <!--            <div class="mb-0 text-center"><small class="text-muted">Investing begins in 17 hours and 33 minutes</small></div>-->
    <!--        </div>-->
    <!--    </div>-->

    <!--</div>-->
    <!--        <div class="col-12">-->
    <!--            <div class="row row-cards">-->
    <!--                <div class="col-6">-->
    <!--                    <div class="card">-->
    <!--                        <div class="card-body">-->
    <!--                            <div class="d-flex align-items-center">-->
    <!--                                <div class="subheader">Asking Price</div>-->
    <!--                            </div>-->
    <!--                            <div class="h1 mb-3">{{ frappe.utils.fmt_money(this_property.price,currency="$") }}</div>-->
    <!--                        </div>-->
    <!--                    </div>-->
    <!--                </div>-->
    <!--                <div class="col-6">-->
    <!--                    <div class="card">-->
    <!--                        <div class="card-body">-->
    <!--                            <div class="d-flex align-items-center">-->
    <!--                                <div class="subheader">Asking Price per SF</div>-->
    <!--                            </div>-->
    <!--                            <div class="h1 mb-3">{{ frappe.utils.fmt_money(this_property.price_sf,currency="$") }}</div>-->
    <!--                        </div>-->
    <!--                    </div>-->
    <!--                </div>-->
    <!--                <div class="col-6">-->
    <!--                    <div class="card">-->
    <!--                        <div class="card-body">-->
    <!--                            <div class="d-flex align-items-center">-->
    <!--                                <div class="subheader">Cap Rate</div>-->
    <!--                            </div>-->
    <!--                            <div class="h1 mb-3">{{ frappe.format(this_property.cap_rate, {'fieldtype': 'Percent'}) }}</div>-->
    <!--                        </div>-->
    <!--                    </div>-->
    <!--                </div>-->
    <!--                <div class="col-6">-->
    <!--                    <div class="card">-->
    <!--                        <div class="card-body">-->
    <!--                            <div class="d-flex align-items-center">-->
    <!--                                <div class="subheader">Net Operating Income</div>-->
    <!--                            </div>-->
    <!--                            <div class="h1 mb-3">{{ frappe.utils.fmt_money(this_property.noi,currency="$") }}</div>-->
    <!--                        </div>-->
    <!--                    </div>-->
    <!--                </div>-->
    <!--            </div>-->
    <!--        </div>-->

    <!--        <div class="col-12">-->
    <!--            {% if doc.broker %}-->
    <!--            {% set broker = frappe.get_doc('Broker', doc.broker) %}-->
    <!--            <div class="card">-->
    <!--                <div class="card-body p-4 pb-1 text-center">-->
    <!--                    <div class="card-title">Have Questions?</div>-->
    <!--                    <div class="card-subtitle">Get your questions answered.</div>-->
    <!--                    <span class="avatar avatar-md mb-3 avatar-rounded" style="background-image: url({{ broker.image }})"></span>-->
    <!--                    <h3 class="m-0 mb-1"><a href="#">{{ broker.full_name }}</a></h3>-->
    <!--                    <div class="text-muted">{{ broker.brokerage }}</div>-->
    <!--                </div>-->
    <!--                <div class="d-flex justify-content-center">-->
    <!--                    <a href="#" class="card-btn" style="display: flow-root;">-->
    <!-- Download SVG icon from http://tabler-icons.io/i/mail -->
    <!--                        <svg xmlns="http://www.w3.org/2000/svg" class="icon me-2 text-muted" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">-->
    <!--                            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>-->
    <!--                            <rect x="3" y="5" width="18" height="14" rx="2"></rect>-->
    <!--                            <polyline points="3 7 12 13 21 7"></polyline>-->
    <!--                        </svg>-->
    <!--                        Message-->
    <!--                    </a>-->
    <!--                    <a href="#" class="card-btn" style="display: flow-root;">-->
    <!-- Download SVG icon from http://tabler-icons.io/i/phone -->
    <!--                        <svg xmlns="http://www.w3.org/2000/svg" class="icon me-2 text-muted" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">-->
    <!--                            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>-->
    <!--                            <path d="M5 4h4l2 5l-2.5 1.5a11 11 0 0 0 5 5l1.5 -2.5l5 2v4a2 2 0 0 1 -2 2a16 16 0 0 1 -15 -15a2 2 0 0 1 2 -2"></path>-->
    <!--                        </svg>-->
    <!--                        Call-->
    <!--                    </a>-->
    <!--                </div>-->
    <!--            </div>-->
    <!--            {% endif %}-->

    <!--        </div>-->


    <!--    </div>-->

    <!--</div>-->
    <!--<div class="col-12">-->
    <!--    <div class="row">-->
    <!--        <div class="col-md-3 m-auto">-->
    <!--            <div class="row row-cards">-->
    <!--                <div class="col-6">-->
    <!--                    <div class="card">-->
    <!--                        <div class="card-body">-->
    <!--                            <div class="d-flex align-items-center">-->
    <!--                                <div class="subheader">Asking Price</div>-->
    <!--                            </div>-->
    <!--                            <div class="h1 mb-3">{{ frappe.utils.fmt_money(this_property.price,currency="$") }}</div>-->
    <!--                        </div>-->
    <!--                    </div>-->
    <!--                </div>-->
    <!--                <div class="col-6">-->
    <!--                    <div class="card">-->
    <!--                        <div class="card-body">-->
    <!--                            <div class="d-flex align-items-center">-->
    <!--                                <div class="subheader">Asking Price per SF</div>-->
    <!--                            </div>-->
    <!--                            <div class="h1 mb-3">{{ frappe.utils.fmt_money(this_property.price_sf,currency="$") }}</div>-->
    <!--                        </div>-->
    <!--                    </div>-->
    <!--                </div>-->
    <!--                <div class="col-6">-->
    <!--                    <div class="card">-->
    <!--                        <div class="card-body">-->
    <!--                            <div class="d-flex align-items-center">-->
    <!--                                <div class="subheader">Cap Rate</div>-->
    <!--                            </div>-->
    <!--                            <div class="h1 mb-3">{{ frappe.format(this_property.cap_rate, {'fieldtype': 'Percent'}) }}</div>-->
    <!--                        </div>-->
    <!--                    </div>-->
    <!--                </div>-->
    <!--                <div class="col-6">-->
    <!--                    <div class="card">-->
    <!--                        <div class="card-body">-->
    <!--                            <div class="d-flex align-items-center">-->
    <!--                                <div class="subheader">Net Operating Income</div>-->
    <!--                            </div>-->
    <!--                            <div class="h1 mb-3">{{ frappe.utils.fmt_money(this_property.noi,currency="$") }}</div>-->
    <!--                        </div>-->
    <!--                    </div>-->
    <!--                </div>-->
    <!--            </div>-->

    <!--        </div>-->
    <!--        <div class="col-md-9 m-auto">-->

    <!--        </div>-->
    <!--    </div>-->

    <!--</div>-->
</div>

{{ frappe.render_template('templates/includes/cre-feedback/cre-feedback.html', {'user_liked': user_liked, 'doctype': 'Property', 'name' : name}) }}

<script type="text/javascript">
    frappe.ready(() => {


        toggle_button();

        $('#comment-content').change(() => {
            toggle_button();
        })


        $('#comment-save').click(() => {
            let new_comment_content = $('#comment-content').val()
            if (new_comment_content) {

                if (new_comment(new_comment_content)) {
                    console.log('comment saved!');
                    $('#comment-content').val('');
                    location.reload();

                }
                else {
                    console.log('something went wrong sumbiting this comment.')
                }



            }

        })


        $('.delete-comment').click(() => {
            let comment_id = $('.delete-comment').attr('id')
            if (comment_id) {

                if (delete_comment(comment_id)) {
                    console.log('comment deleted!');
                    location.reload();
                }
                else {
                    console.log('something went wrong deleting this comment.')
                }



            }

        })

        function toggle_button() {
            let comment_content = $('#comment-content').val();
            if (!comment_content) {

                $('#comment-save').addClass('disabled');
            }
            else {
                $('#comment-save').removeClass('disabled');

            }
        }

        let new_comment = function(content) {
            //reference_doctype, reference_name, content, comment_email, comment_by

            return frappe.call({
                method: "cre.investorexp.new_comment",
                args: {
                    reference_doctype: "{{ doctype }}",
                    reference_name: "{{ name }}",
                    content: content,
                    comment_email: "{{ user }}",
                    comment_by: "{{ user }}"


                }
            });
        }

        let delete_comment = function(comment_id) {
            //reference_doctype, reference_name, content, comment_email, comment_by

            return frappe.call({
                method: "cre.investorexp.delete_comment",
                args: {
                    comment_id: comment_id
                }
            });
        }

    });
</script>

{% endblock %}
